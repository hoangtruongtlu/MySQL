CREATE DATABASE Test;
USE Test;

CREATE TABLE Department (
	DepartmentID TINYINT AUTO_INCREMENT PRIMARY KEY,
    DepartmentName VARCHAR(50) NOT NULL UNIQUE KEY
);

CREATE TABLE Position1 (
	PositionID TINYINT AUTO_INCREMENT PRIMARY KEY,
    PositionName ENUM('Dev','Test','Scrum Master','PM') NOT NULL
);

CREATE TABLE Account (
	  AccountID TINYINT AUTO_INCREMENT PRIMARY KEY,
    Email VARCHAR(50) NOT NULL UNIQUE KEY,
    UserName VARCHAR(50) NOT NULL UNIQUE KEY,
    FUllName VARCHAR(50) NOT NULL,
    DepartmentID TINYINT NOT NULL,
    PositionID TINYINT NOT NULL,
    CreateDate DATE NOT NULL,
    FOREIGN KEY (DepartmentID) REFERENCES Department(DepartmentID),
    FOREIGN KEY (PositionID) REFERENCES Position1(PositionID)
);

CREATE TABLE Group1 (
	  GroupID TINYINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
    GroupName VARCHAR(20) NOT NULL UNIQUE KEY,
    CreatorID INT NOT NULL,
    CreateDate DATE NOT NULL
);

CREATE TABLE GroupAccount(
	  GroupID TINYINT UNSIGNED AUTO_INCREMENT,
    AccountID TINYINT NOT NULL,
    PRIMARY KEY (GroupID, AccountID),
    JoinDate DATE NOT NULL
);

CREATE TABLE TypeQuestion(
	  TypeID TINYINT AUTO_INCREMENT PRIMARY KEY,
    TypeName ENUM('Essay','Multiple-Choice') NOT NULL
);

CREATE TABLE CategoryQuestion(
	  CategoryID TINYINT AUTO_INCREMENT PRIMARY KEY,
    CategoryName VARCHAR(50) NOT NULL
);

CREATE TABLE Question(
	  QuestionID TINYINT AUTO_INCREMENT PRIMARY KEY,
    Content VARCHAR(50) NOT NULL,
    CategoryID TINYINT NOT NULL,
    TypeID TINYINT NOT NULL,
    CreatorID INT NOT NULL,
    CreateDate DATE NOT NULL,
    FOREIGN KEY (CategoryID) REFERENCES CategoryQuestion(CategoryID),
    FOREIGN KEY (TypeID) REFERENCES TypeQuestion(TypeID)
);

CREATE TABLE Answer(
	  AnswerID TINYINT AUTO_INCREMENT PRIMARY KEY,
    Content VARCHAR(50) NOT NULL,
    QuestionID TINYINT NOT NULL,
    IsCorrect BOOL NOT NULL,
    FOREIGN KEY (QuestionID) REFERENCES Question(QuestionID)
);

CREATE TABLE Exam(
	  ExamID TINYINT AUTO_INCREMENT PRIMARY KEY,
    Code VARCHAR(10) NOT NULL,
    Title VARCHAR(50) NOT NULL,
    CategoryID TINYINT NOT NULL,
    Duration DATE NOT NULL,
    CreatorID INT NOT NULL,
    CreateDate DATE NOT NULL,
    FOREIGN KEY (CategoryID) REFERENCES CategoryQuestion(CategoryID)
);

CREATE TABLE ExamQuestion(
	  ExamID TINYINT NOT NULL,
    QuestionID TINYINT NOT NULL,
    FOREIGN KEY (ExamID) REFERENCES Exam(ExamID),
    FOREIGN KEY (QuestionID) REFERENCES Question(QuestionID),
    PRIMARY KEY(ExamID,QuestionID)
);

DROP TABLE IF EXISTS Department;
DROP TABLE IF EXISTS Position1;
DROP TABLE IF EXISTS Account;
DROP TABLE IF EXISTS Group1;
DROP TABLE IF EXISTS GroupAccount;
DROP TABLE IF EXISTS TypeQuestion;
DROP TABLE IF EXISTS CategoryQuestion;
DROP TABLE IF EXISTS Question;
DROP TABLE IF EXISTS Answer;
DROP TABLE IF EXISTS Exam;
DROP TABLE IF EXISTS ExamQuestion;
